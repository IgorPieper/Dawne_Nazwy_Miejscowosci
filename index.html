<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dawne Nazwy Miejscowości</title>
  <meta name="description" content="Wyszukiwarka dawnych i alternatywnych nazw polskich miejscowości." />
  <meta name="color-scheme" content="light dark" />

  <style>
    :root{
      --bg:#0b1020;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.08);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.66);
      --border:rgba(255,255,255,.14);
      --shadow:0 22px 70px rgba(0,0,0,.35);
      --r:18px;
      --r2:14px;
      --sans:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      --mono:ui-monospace,Menlo,Consolas,monospace;
      --a1:#7c5cff;
      --a2:#35d0ff;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f7f8fb;
        --card:rgba(0,0,0,.04);
        --card2:rgba(0,0,0,.06);
        --text:rgba(0,0,0,.88);
        --muted:rgba(0,0,0,.6);
        --border:rgba(0,0,0,.12);
        --shadow:0 18px 55px rgba(0,0,0,.12);
      }
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 0%, rgba(124,92,255,.35), transparent 60%),
        radial-gradient(900px 600px at 90% 10%, rgba(53,208,255,.25), transparent 55%),
        var(--bg);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:40px 20px 70px}

    .topbar{
      display:flex;justify-content:space-between;align-items:center;margin-bottom:18px
    }
    .brand{display:flex;gap:10px;align-items:center;font-weight:800}
    .logo{
      width:34px;height:34px;border-radius:12px;
      background:linear-gradient(135deg,var(--a1),var(--a2))
    }
    .pill{
      padding:8px 12px;border-radius:999px;
      border:1px solid var(--border);
      background:var(--card);
      font-size:13px;color:var(--muted)
    }

    header{
      padding:22px;
      border-radius:var(--r);
      border:1px solid var(--border);
      background:linear-gradient(180deg,var(--card2),var(--card));
      box-shadow:var(--shadow)
    }
    h1{margin:0;font-size:clamp(26px,3vw,42px)}
    .sub{margin:10px 0 0;color:var(--muted)}

    .search{margin-top:16px;display:grid;gap:12px}
    .searchbox{
      display:flex;gap:10px;align-items:center;
      padding:12px 14px;border-radius:var(--r2);
      border:1px solid var(--border);background:rgba(255,255,255,.03)
    }
    input{
      width:100%;border:none;background:none;color:inherit;font-size:16px;outline:none
    }
    .btn{
      padding:8px 12px;border-radius:10px;
      border:1px solid var(--border);background:var(--card);color:inherit;cursor:pointer
    }

    .controls{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .toggle{
      display:flex;gap:8px;align-items:center;
      padding:8px 12px;border-radius:999px;
      border:1px solid var(--border);background:var(--card);font-size:13px
    }
    .toggle input{display:none}
    .dot{
      width:10px;height:10px;border-radius:50%;
      border:1px solid var(--border)
    }
    .toggle input:checked + .dot{
      background:linear-gradient(135deg,var(--a1),var(--a2))
    }

    .status{
      display:flex;justify-content:space-between;
      margin:14px 4px;font-size:13px;color:var(--muted);flex-wrap:wrap
    }
    .kbd{
      font-family:var(--mono);font-size:12px;
      padding:2px 6px;border-radius:6px;
      border:1px solid var(--border)
    }

    main{margin-top:16px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .card{
      grid-column:span 12;
      padding:16px;border-radius:var(--r);
      border:1px solid var(--border);
      background:linear-gradient(180deg,var(--card2),var(--card))
    }
    @media(min-width:820px){.card{grid-column:span 6}}
    .name{font-weight:900;font-size:18px}
    .loc{font-size:13px;color:var(--muted);margin-top:4px}
    .chips{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
    .chip{
      padding:6px 10px;border-radius:999px;
      border:1px solid var(--border);font-size:13px
    }
    mark{background:rgba(251,191,36,.25)}
  </style>
</head>

<body>
<div class="wrap">

  <div class="topbar">
    <div class="brand"><div class="logo"></div>Dawne Nazwy Miejscowości</div>
    <div class="pill" id="metaPill">Wczytuję…</div>
  </div>

  <header>
    <h1>Wyszukiwarka nazw miejscowości</h1>
    <p class="sub">Szukaj po nazwie obecnej, dawnej lub obcojęzycznej.</p>

    <div class="search">
      <div class="searchbox">
        <input id="q" placeholder="Np. Wrocław, Breslau, Danzig…" />
        <button class="btn" id="clearBtn">Wyczyść</button>
      </div>

      <div class="controls">
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <label class="toggle"><input id="tName" checked><span class="dot"></span>Nazwa</label>
          <label class="toggle"><input id="tAlt" checked><span class="dot"></span>Inne nazwy</label>
          <label class="toggle"><input id="tLoc"><span class="dot"></span>Lokalizacja</label>
        </div>
        <button class="btn" id="copyBtn">Kopiuj wyniki</button>
      </div>
    </div>
  </header>

  <div class="status">
    <div id="statusLeft">Wpisz frazę, aby zobaczyć wyniki.</div>
    <div><span class="kbd">/</span> fokus • <span class="kbd">Esc</span> wyczyść</div>
  </div>

  <main>
    <div id="results" class="grid"></div>
  </main>
</div>

<script>
const DATA_URL = "Miejscowosci.json";

const els = {
  q: q,
  results,
  metaPill,
  statusLeft,
  tName,
  tAlt,
  tLoc,
  clearBtn,
  copyBtn
};

let db = [];

const norm = s => (s||"").toLowerCase();
const esc = s => s.replace(/[&<>"']/g,m=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;" }[m]));

function render(list, q){
  els.results.innerHTML="";
  for(const e of list){
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <div class="name">${esc(e.nazwa)}</div>
      <div class="loc">${esc(e.lokalizacja||"")}</div>
      <div class="chips">${
        (e.inne_nazwy||[]).map(n=>`<span class="chip">${esc(n)}</span>`).join("") || ""
      }</div>`;
    els.results.appendChild(card);
  }
}

function search(){
  const q=norm(els.q.value);
  if(!q){render([]);els.statusLeft.textContent="Wpisz frazę, aby zobaczyć wyniki.";return;}
  const res=db.filter(e=>
    (els.tName.checked && norm(e.nazwa).includes(q)) ||
    (els.tAlt.checked && (e.inne_nazwy||[]).some(n=>norm(n).includes(q))) ||
    (els.tLoc.checked && norm(e.lokalizacja).includes(q))
  );
  render(res,q);
  els.statusLeft.textContent = res.length ? `Wyniki: ${res.length}` : "Brak wyników.";
}

async function init(){
  const r=await fetch(DATA_URL);
  const j=await r.json();
  db=j.miejscowosci||[];
  els.metaPill.textContent=`Wpisów: ${db.length}`;
}

els.q.oninput=search;
els.clearBtn.onclick=()=>{els.q.value="";render([]);els.statusLeft.textContent="Wpisz frazę, aby zobaczyć wyniki.";};
document.onkeydown=e=>{
  if(e.key==="/"){e.preventDefault();els.q.focus();}
  if(e.key==="Escape"){els.clearBtn.onclick();}
};

init();
</script>
</body>
</html>
